@import utils.EmailAddress
@(report: Report, files: List[ReportFile])(implicit contactAddress: EmailAddress)

@import utils.Constants.ReportStatus._

@views.html.mails.layout("Votre signalement") {

    <p>
        Bonjour @report.firstName @report.lastName,
    </p>
    @report.status match {
        case NA => {
            <p>
                Le site SignalConso fonctionne uniquement dans les régions Centre-Val de Loire, Auvergne-Rhône-Alpes et Occitanie, comme nous l'indiquons sur notre site.
            </p>
            <p>
                Votre signalement ne sera pas transmis au commerçant et à la répression des fraudes de la région. Par contre, il reste enregistré dans la base de données de la répression des fraudes.
            </p>
            <p>
                En attendant de déployer SignalConso sur toute la France, vous pouvez contacter la DGCCRF via : <a href="https://www.economie.gouv.fr/contact/contacter-la-dgccrf?dest=particulier">https://www.economie.gouv.fr/contact/contacter-la-dgccrf?dest=particulier</a>
            </p>
        }
        case EMPLOYEE_REPORT => {
            <p>
                <b>Votre signalement a bien été enregistré dans SignalConso.</b>
            </p>
            <p>
                Vous avez indiqué être employé de l'entreprise que vous avez signalée.
            </p>
            <p>
                Afin de garantir la sécurité de votre emploi, votre signalement ne sera pas envoyé à l'entreprise.
            </p>
            <p>
                <b>Par contre les enquêteurs de la répression des fraudes seront informés de votre signalement.</b>
            </p>
        }
        case _ => {
            <p>
                <b>Votre signalement a bien été enregistré dans SignalConso.</b>
            </p>
            <p>
                Que va-t-il se passer ?
            </p>
            <p>
                <b>L'entreprise va être informée de votre signalement pour qu'elle puisse corriger le problème.</b>
            </p>

            <p>
                Dès que l'entreprise aura lu le signalement, vous recevrez un email.
                En moyenne l'entreprise met 8 jours pour lire le signalement.
            </p>
            <p>
                Si, malgré nos relances, l'entreprise ne souhaite pas consulter votre signalement, vous serez informé de son refus.
            </p>

            <p>
                Que l'entreprise lise ou non votre signalement,
                <b>les enquêteurs de la répression des fraudes seront également informés de votre signalement.</b>
            </p>
        }
    }

    <p>
        Vous avez une question ? Vous souhaitez modifier votre signalement ? <a href="mailto:@contactAddress">Contactez-nous</a>.
    </p>

    <p>À bientôt sur SignalConso !</p>

    <p>
        <i>L'équipe SignalConso</i>
    </p>

    @if(report.status != NA) {
        <p style="text-align: center;
            margin: 30px">
            <a href="https://monavis.numerique.gouv.fr/Demarches/2071?&view-mode=formulaire-avis&nd_mode=en-ligne-enti%C3%A8rement&nd_source=button&key=5a58254dab900906fe4924e37c1c5bba">
                <img src="https://monavis.numerique.gouv.fr/monavis-static/bouton-bleu.png" alt="Je donne mon avis" title="Je donne mon avis sur cette démarche" />
            </a>
        </p>
    }


    <div style="padding-bottom: 0.5em">
        <div style="font-weight: bold;
            text-align: center;
            border-top: 1px solid #D3D3D3;
            border-bottom: 1px solid #D3D3D3;
            padding: 10px 0;
            margin: 10px">Détail du signalement</div>

        <b>Problème</b>
        <br/>
        @report.category
        <br />
        @report.subcategories.map {subcategory =>
            @subcategory
            <br />
        }

        <br />
        <b>Description</b>
        <br/>
        @report.details.map { detailInputValue =>
            @Html(detailInputValue.label) @Html(detailInputValue.value)
            <br/>
        }

        @if(files.length > 0) {
            <br/>
            Pièces jointes :
            <ul>
            @files.map { file =>
                <li>
                    @file.filename
                </li>
            }
            </ul>
        } else {
            <br />
        }

        <b>Entreprise</b>
        <br/>
        @report.companyAddress
        <br/>

        <br />
        <b>Consommateur</b>
        <br/>
        Nom : @report.lastName
        <br />
        Prénom : @report.firstName
        <br />
        Email : @report.email
        <br/>
        @if(!report.employeeConsumer) {
            Accord pour contact : @if(report.contactAgreement) {oui} else {non}
            <br/>
        }
    </div>

    <div style="padding-bottom: 0.5em">
        <div style="font-weight: bold;
            text-align: center;
            border-top: 1px solid #D3D3D3;
            border-bottom: 1px solid #D3D3D3;
            padding: 10px 0;
            margin: 10px">Comprendre SignalConso</div>
        <img src="cid:schemaSignalConso-Etape2" style="max-width: 100%"/>
    </div>
}